{% extends '::base.html.twig' %}

{% block pageheader %}
    <h1>Pln</h1>
{% endblock %}

{% macro pln_props(props) %}
    {% import _self as macros %}
    <ul>
        {% for prop in props %}
            <li>{{ prop.propertyKey }}:
                {% if prop.hasChildren() %}
                    {{ macros.pln_props(prop.children) }}
                {% else %}
                    {% if prop.propertyValue is iterable %}
                        <ul>
                        {% for v in prop.propertyValue %}
                            <li>{{ v }} </li>
                        {% endfor %}
                        </ul>
                    {% else %}
                        {{ prop.propertyValue }}
                    {% endif %}
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% endmacro %}

{% block body -%}
    <ul class="record_actions">
        <li>
            <a href="{{ path('pln') }}">
                Back to the list
            </a>
        </li>
        <li>
            <a href="{{ path('pln_access', { 'id': entity.id }) }}">Show access</a>
        </li>

        <li>
            <a href="{{ path('pln_edit', { 'id': entity.id }) }}">
                <span class='glyphicon glyphicon-edit'></span>
            </a>
        </li>

        <li>
            <a href="{{ path('pln_delete', { 'id': entity.id }) }}" class="js-confirm" data-confirm="Are you sure you want to delete this Pln?">
                <span class='glyphicon glyphicon-remove'></span>
            </a>
        </li>
    </ul>

    <table class="record_properties table table-striped table-bordered table-hover">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ entity.id }}</td>
            </tr>
            <tr>
                <th>Name</th>
                <td>{{ entity.name }}</td>
            </tr>
            <tr>
                <th>Propserver</th>
                <td>{{ entity.propserver }}</td>
            </tr>
            <tr>
                <th>Propspath</th>
                <td>{{ entity.propsPath }}</td>
            </tr>
        </tbody>
    </table>

    <h2>Boxes</h2>
    <table class="records_list table table-striped table-bordered table-hover">
        <thead>
            <tr>
                <th>Hostname</th>
                <th>Ipaddress</th>
                <th>Username</th>
                <th>Password</th>
            </tr>
        </thead>
        <tbody>
            {% for box in entity.boxes %}
                <tr>
                    <td><a href="{{ path('box_show', { 'id': box.id }) }}">{{ box.hostname }}</a></td>
                    <td>{{ box.ipAddress }}</td>
                    <td>{{ box.username }}</td>
                    <td>{{ box.password }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2>All Properties</h2>
    {% import _self as macros %}
    {{ macros.pln_props(entity.getRootPluginProperties()) }}
    
{% endblock %}
